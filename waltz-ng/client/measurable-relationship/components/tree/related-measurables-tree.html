<!--
  ~ Waltz - Enterprise Architecture
  ~ Copyright (C) 2016, 2017, 2018, 2019 Waltz open source project
  ~ See README.md for more information
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific
  ~
  -->

<treecontrol class="tree-light"
             tree-model="$ctrl.treeData"
             expanded-nodes="$ctrl.expandedNodes"
             options="$ctrl.treeOptions"
             on-selection="$ctrl.onSelect(node)"
             order-by="['-position', '-name']">
        <span class="no-overflow">
            <span ng-bind="node.displayName"
                  uib-popover-template="'wrmt-popover.html'"
                  popover-trigger="mouseenter"
                  popover-append-to-body="true"
                  popover-placement="top"
                  popover-popup-delay="300"
                  popover-enable="node.description.length > 0 || node.name.length > 96"
                  ng-class="{ 'italics' : ! node.direct }">
            </span>
        </span>
</treecontrol>

<div ng-if="$ctrl.selectedNode">
    <hr>
    <h4>
        <span ng-bind="$ctrl.selectedNode.name"></span>
        <small>
            <a ui-sref="main.measurable.view ({id: $ctrl.selectedNode.id })">
                Visit
            </a>
        </small>
    </h4>
    <div ng-bind="$ctrl.selectedNode.description"></div>

</div>



<script type="text/ng-template"
        id="wrmt-popover.html">
    <div class="small">
        <strong ng-bind="node.name"></strong>
        <hr>
        <waltz-markdown text="node.description"></waltz-markdown>
    </div>
</script>