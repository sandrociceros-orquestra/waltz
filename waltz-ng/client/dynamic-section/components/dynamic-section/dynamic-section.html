<!--
  ~ Waltz - Enterprise Architecture
  ~ Copyright (C) 2016, 2017, 2018, 2019 Waltz open source project
  ~ See README.md for more information
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific
  ~
  -->

<div>
    <div class="waltz-dynamic-section-header">

        <div class="waltz-visibility-parent waltz-dynamic-section-header-title">
            <span class="waltz-visibility-child-30 clickable"
                  ng-click="$ctrl.onRemove($ctrl.section)"
                  ng-if="$ctrl.onRemove"
                  title="Close">
                <waltz-icon name="times">
                </waltz-icon>
            </span>
            <span ng-if="$ctrl.onRemove == null">
                <waltz-icon fixed-width="true"></waltz-icon>
            </span>

            <span class="small no-text-select waltz-visibility-child-30">
                <a ng-if="!$ctrl.embedded"
                   ui-sref="embed.internal ({kind: $ctrl.parentEntityRef.kind, id: $ctrl.parentEntityRef.id, sectionId: $ctrl.section.id })">
                    <waltz-icon name="share-square-o"
                                title="Embed section">
                    </waltz-icon>
                </a>
                <a ng-if="$ctrl.embedded"
                   target="_blank"
                   ui-sref="main.entity.ref ({kind: $ctrl.parentEntityRef.kind, id: $ctrl.parentEntityRef.id})">
                    <waltz-icon name="share-square-o"
                                title="Embed section"
                                flip="horizontal">
                    </waltz-icon>
                </a>
            </span>


            <span class="small no-text-select waltz-visibility-child-30">
                <button ng-click="$ctrl.onShare()"
                        class="btn-skinny"
                        title="Copy url to clipboard for sharing">
                    <waltz-icon name="share-nodes"></waltz-icon>
                </button>
            </span>

            <span>
                <waltz-icon name="{{ $ctrl.section.icon }}"></waltz-icon>
                <span ng-bind="$ctrl.section.name"></span>
            </span>
        </div>
    </div>

    <div class="container-fluid waltz-dynamic-section-body">
        <ng-transclude></ng-transclude>
    </div>
</div>

<div ng-if="$ctrl.help"
     class="waltz-dynamic-section-help">

    <div class="help-block">
        <waltz-icon name="info-circle">
        </waltz-icon>

        <waltz-markdown text="$ctrl.help"
                        context="{parentEntityRef: $ctrl.parentEntityRef}">
        </waltz-markdown>
    </div>
</div>